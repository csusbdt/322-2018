<h1>Javascript Lecture on Fetch</h1>

<p id="stockprice"></p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
function assert(e) {
  if (!eval(e)) {
    let msg = '<p>Assertion failed: ' + e + '</p>';
    document.write(msg);
    console.log(msg);
  }
}
</script>

<script type="text/javascript">
// https://stackoverflow.com/questions/5150040/stock-quotes-with-javascript
function getStockQuote() {
  var symbols = ["goog", "aapl", "msft"];
  var callback = function(data) {
    var results = "";
console.log(data.query);
//    $.each(data.query.results.quote, function(i, value){
//      results += value.Name + ":$" + value.LastTradePriceOnly + " ";
//    });
    alert(results);
    //let el = document.getElementById('stockprice');
    //el.innerHTML = '?';
  };
  var url = "https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quote%20where%20symbol%20in%20(";
  $.each(symbols, function(j, code){
    url += "%22" + code + "%22";
    if (j < (symbols.length-1)){
       url += "%2C";
    }
  });
  url += ")&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=";
  $.getJSON(url, callback);
}
</script>

<script>
setTimeout(getStockQuote, 2000);
</script>

